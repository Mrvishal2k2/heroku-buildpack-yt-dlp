#!/usr/bin/env bash

set -eo pipefail
BUILD_DIR=${1:-}
cd $BUILD_DIR
mkdir -p vendor
cd vendor
curl --location https://github.com/yt-dlp/yt-dlp/releases/download/2021.12.01/yt-dlp -o yt-dlp
echo '77623d626b11d4222ac39fed6e778782a04ca0c5  yt-dlp' > yt-dlp.sha
shasum --check yt-dlp.sha
chmod a+rx yt-dlp
./yt-dlp --version
PROFILE_PATH="$BUILD_DIR/.profile.d/yt-dlp.sh"
mkdir -p $(dirname $PROFILE_PATH)
echo 'export PATH="$PATH:${HOME}/vendor/yt-dlp"' >> $PROFILE_PATH
